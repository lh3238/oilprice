<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>oil price analysis - 3&nbsp; Results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./d3graph.html" rel="next">
<link href="./data.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./results.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">oil price analysis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/lh3238/oilprice" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./d3graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive graph</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ratio-of-regional-oil-exports-to-total-world-export" id="toc-ratio-of-regional-oil-exports-to-total-world-export" class="nav-link active" data-scroll-target="#ratio-of-regional-oil-exports-to-total-world-export"><span class="header-section-number">3.1</span> Ratio of Regional Oil Exports to Total World Export</a></li>
  <li><a href="#time-series-analysis" id="toc-time-series-analysis" class="nav-link" data-scroll-target="#time-series-analysis"><span class="header-section-number">3.2</span> Time Series Analysis</a></li>
  <li><a href="#price-analysis-of-different-petroleum-products-in-the-us-gulf" id="toc-price-analysis-of-different-petroleum-products-in-the-us-gulf" class="nav-link" data-scroll-target="#price-analysis-of-different-petroleum-products-in-the-us-gulf"><span class="header-section-number">3.3</span> Price Analysis of Different Petroleum Products in the US Gulf</a></li>
  <li><a href="#box-plots-for-global-event-impact-analysis" id="toc-box-plots-for-global-event-impact-analysis" class="nav-link" data-scroll-target="#box-plots-for-global-event-impact-analysis"><span class="header-section-number">3.4</span> Box Plots for Global Event Impact Analysis</a></li>
  <li><a href="#density-plot-for-policy-impact-analysis" id="toc-density-plot-for-policy-impact-analysis" class="nav-link" data-scroll-target="#density-plot-for-policy-impact-analysis"><span class="header-section-number">3.5</span> Density Plot for Policy Impact Analysis</a></li>
  <li><a href="#correlations-between-various-economic-indicators-and-oil-prices" id="toc-correlations-between-various-economic-indicators-and-oil-prices" class="nav-link" data-scroll-target="#correlations-between-various-economic-indicators-and-oil-prices"><span class="header-section-number">3.6</span> Correlations Between Various Economic Indicators and Oil Prices</a></li>
  <li><a href="#multivariate-analysis-of-the-impact-of-production-factors" id="toc-multivariate-analysis-of-the-impact-of-production-factors" class="nav-link" data-scroll-target="#multivariate-analysis-of-the-impact-of-production-factors"><span class="header-section-number">3.7</span> Multivariate Analysis of the Impact of Production Factors</a></li>
  <li><a href="#multivariate-analysis-of-the-impact-of-production-factors-1" id="toc-multivariate-analysis-of-the-impact-of-production-factors-1" class="nav-link" data-scroll-target="#multivariate-analysis-of-the-impact-of-production-factors-1"><span class="header-section-number">3.8</span> Multivariate Analysis of the Impact of Production Factors</a></li>
  <li><a href="#interplay-of-tax-policies-and-gdp-growth-on-oil-price-segments" id="toc-interplay-of-tax-policies-and-gdp-growth-on-oil-price-segments" class="nav-link" data-scroll-target="#interplay-of-tax-policies-and-gdp-growth-on-oil-price-segments"><span class="header-section-number">3.9</span> Interplay of Tax Policies and GDP Growth on Oil Price Segments</a></li>
  <li><a href="#correlations-between-dirty-tanker-price-and-oil-price" id="toc-correlations-between-dirty-tanker-price-and-oil-price" class="nav-link" data-scroll-target="#correlations-between-dirty-tanker-price-and-oil-price"><span class="header-section-number">3.10</span> Correlations between Dirty Tanker Price and Oil Price</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/lh3238/oilprice/edit/main/results.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/lh3238/oilprice/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="ratio-of-regional-oil-exports-to-total-world-export" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="ratio-of-regional-oil-exports-to-total-world-export"><span class="header-section-number">3.1</span> Ratio of Regional Oil Exports to Total World Export</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"ASB2023_all/T52_pruned.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>data[,<span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(data[,<span class="sc">-</span><span class="dv">1</span>], <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, x)))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>total_world_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, Region <span class="sc">==</span> <span class="st">"Total_world"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, Region <span class="sc">!=</span> <span class="st">"Total_world"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>ratios <span class="ot">&lt;-</span> data</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> <span class="fu">names</span>(data)[<span class="sc">-</span><span class="dv">1</span>]) {</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  ratios[[year]] <span class="ot">&lt;-</span> data[[year]] <span class="sc">/</span> total_world_data[[year]]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>ratios_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(ratios, <span class="at">cols =</span> <span class="sc">-</span>Region, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Ratio"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ratios_long, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Ratio, <span class="at">group =</span> Region, <span class="at">color =</span> Region)) <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ratio of Regional Oil Exports to Total World Export Over Time"</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Ratio to Total World Export"</span>) <span class="sc">+</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We used a stacked bar chart to compare the relationship between regional and organizational oil export volumes and the total world oil export volume. Compared to using simple bar or line charts, this approach not only informs us about the historical oil export volumes of regions and organizations but also shows the proportion of these exports in the world’s total oil exports. Understanding both aspects is crucial for analyzing oil prices, as the amount of oil exported determines the influence of a region or organization on global oil prices. However, knowing the export volume alone is insufficient. For instance, while OPEC’s oil exports in 2022 increased compared to 1980, its share in the global oil export market has declined. By comparing the export volumes of other regions, we found that OECD’s oil exports have been increasing annually. This can be attributed to two main reasons. First, since 2010, the maturation of shale oil extraction technology in the United States has turned it into a major oil exporter, thereby encroaching on OPEC’s market share. Second, for political and security reasons, the OECD, led by the United States, intentionally reduced its reliance on oil imports from OPEC countries and gradually shifted to purchasing oil from other regions. Interactive graphics created with D3 make it easier and clearer for us to identify these trends, thereby assisting us in conducting a more objective and accurate analysis of other aspects.</p>
</section>
<section id="time-series-analysis" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="time-series-analysis"><span class="header-section-number">3.2</span> Time Series Analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T74.xlsx"</span>, <span class="at">skip =</span> <span class="dv">2</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> oil_price[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> oil_price[<span class="sc">-</span><span class="dv">2</span>, ]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Type"</span>, <span class="fu">seq</span>(<span class="dv">1972</span>, <span class="dv">2022</span>))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> <span class="fu">rbind</span>(year, oil_price)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(oil_price) <span class="ot">&lt;-</span> oil_price[<span class="dv">1</span>, ]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> oil_price[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>oil_price<span class="sc">$</span>Type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Nominal oil price"</span>, <span class="st">"Nominal price adjusted for exchange rates"</span>, <span class="st">"Nominal price adjusted for inflation"</span>, <span class="st">"Nominal price adjusted for inflation and exchange rates"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>long_oil_price <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(oil_price, <span class="at">cols =</span> <span class="sc">-</span>Type, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Price"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>long_oil_price<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(long_oil_price<span class="sc">$</span>Year)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_oil_price, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="fu">as.numeric</span>(Price), <span class="at">group =</span> Type)) <span class="sc">+</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Type) <span class="sc">+</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Oil Price Trends"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Price ($/b)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The top left graph shows the nominal price of oil without any adjustments. There is a general upward trend with some fluctuations. The top right graph adjusts the nominal price for exchange rate fluctuations. The overall trend is similar to the nominal price trend, with slight differences in the peaks and troughs, indicating the impact of exchange rates on oil prices. When adjusted for inflation, the price trends show less dramatic growth over time, suggesting that some of the increases in nominal price can be attributed to inflation. The early 1980s peak is much more pronounced in this graph compared to the nominal price, indicating that the real value of oil was particularly high during that period. The bottom right graph combines both adjustments for inflation and exchange rates, providing a more comprehensive view of the real oil price trends. The trend is smoother than the nominal graph but shows significant peaks and troughs that correspond with significant historical events affecting the oil market. The price trends generally follow the same patterns across all facets, which suggests that the adjustments for exchange rates and inflation do not dramatically alter the overall shape of the trends, while the trends in oil prices show significant volatility, with notable increases during periods of geopolitical tension or economic events that disrupted oil supply or increased demand, such as 1973-1974 Oil Crisis, 1979-1980 Iranian Revolution and Iran-Iraq War, 1986 Oil Price Collapse, 1990-1991 Gulf War, Late 1990s Asian Financial Crisis, 2000s Energy Crisis, 2008 Financial Crisis, and 2020 COVID-19 Pandemic.</p>
</section>
<section id="price-analysis-of-different-petroleum-products-in-the-us-gulf" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="price-analysis-of-different-petroleum-products-in-the-us-gulf"><span class="header-section-number">3.3</span> Price Analysis of Different Petroleum Products in the US Gulf</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>product <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T76.xlsx"</span>, <span class="at">skip=</span><span class="dv">2</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, ]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>product <span class="ot">&lt;-</span> product[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>long_product <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(product, <span class="at">cols =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Price"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(long_product) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Product"</span>, <span class="st">"Year"</span>, <span class="st">"Price"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_product, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Price, <span class="at">color =</span> Product)) <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Product, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Yearly Spot Prices of Petroleum Products in US Gulf"</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Spot Price ($/b)"</span>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The prices of all three products exhibit similar fluctuations over the years, reflecting the volatile pattern of oil prices in the above time series analysis. Gasoline and Gasoil exhitbit similar prices over the years, while Fuel oil tends to have the lowest price points. This pattern can be explained by the following reasoning: while Gasoline and Gasoil are predominantly used for transportation, a sector that experiences relatively consistent and growing demand, Fuel oil’s usage is more niche and is being increasingly replaced by other fuels due to environmental concerns, which suppresses its price. Also, Gasoline and Gasoil require more complex refining, which is more expensive. On the other hand, Fuel oil, being a heavier product, requires less refining. There are notable peaks and troughs which might correspond to significant global events, changes in market dynamics, or policy decisions that impacted oil prices. Price spikes may align with events that disrupt supply, such as geopolitical conflicts in oil-producing regions (e.g., the Gulf War, sanctions on oil-producing countries), natural disasters affecting production (e.g., hurricanes hitting the Gulf Coast), or decisions by oil-producing countries to cut production. Economic booms lead to higher demand for energy, driving up prices, while recessions can cause a drop in demand and prices. The global financial crisis of 2008, for example, saw a sharp decrease in commodity prices, including oil. Implementation of environmental policies or changes in subsidies for fossil fuels can impact prices. For instance, the adoption of cleaner energy technologies and stricter emission regulations can reduce demand for certain oil products, affecting their prices.</p>
</section>
<section id="box-plots-for-global-event-impact-analysis" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="box-plots-for-global-event-impact-analysis"><span class="header-section-number">3.4</span> Box Plots for Global Event Impact Analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>covid <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T72.xlsx"</span>, <span class="at">skip=</span><span class="dv">25</span>, <span class="at">col_types =</span> <span class="st">"numeric"</span>)[<span class="dv">22</span>, ]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(covid) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Price"</span>, <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">228</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>long_covid <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(covid, <span class="at">cols =</span> <span class="sc">-</span>Price, <span class="at">names_to =</span> <span class="st">"Time"</span>, <span class="at">values_to =</span> <span class="st">"Oil_Price"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>long_covid<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2004-01-01"</span>), <span class="fu">as.Date</span>(<span class="st">"2022-12-31"</span>), <span class="at">by =</span> <span class="st">"month"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>long_covid<span class="sc">$</span>Period <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  long_covid<span class="sc">$</span>Time <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2019-07-01"</span>) <span class="sc">&amp;</span> long_covid<span class="sc">$</span>Time <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2020-02-29"</span>) <span class="sc">~</span> <span class="st">"Pre-Pandemic"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  long_covid<span class="sc">$</span>Time <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2020-03-01"</span>) <span class="sc">&amp;</span> long_covid<span class="sc">$</span>Time <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2020-12-31"</span>) <span class="sc">~</span> <span class="st">"Pandemic"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  long_covid<span class="sc">$</span>Time <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2021-01-01"</span>) <span class="sc">&amp;</span> long_covid<span class="sc">$</span>Time <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2021-12-31"</span>) <span class="sc">~</span> <span class="st">"Post-Pandemic"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Outside"</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>long_covid_filtered <span class="ot">&lt;-</span> long_covid <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Period <span class="sc">!=</span> <span class="st">"Outside"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>long_covid_filtered<span class="sc">$</span>Period <span class="ot">&lt;-</span> <span class="fu">factor</span>(long_covid_filtered<span class="sc">$</span>Period, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pre-Pandemic"</span>, <span class="st">"Pandemic"</span>, <span class="st">"Post-Pandemic"</span>))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_covid_filtered, <span class="fu">aes</span>(<span class="at">x =</span> Period, <span class="at">y =</span> Oil_Price, <span class="at">fill =</span> Period)) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Oil Prices During COVID-19 Periods"</span>,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Period"</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Price ($/b)"</span>) <span class="sc">+</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The sudden drop in demand due to worldwide lockdowns and travel restrictions caused a historical drop in oil prices. Here we use side-by-side box plots to explore the impact of the COVID-19 pandemic on oil prices. The oil prices appear to be higher and less volatile during the pre-pandemic period, with a narrower interquartile range, indicating less variability in prices. The median price is within the upper half of the IQR, suggesting a slight skew towards higher prices within this period. There are no visible outliers, indicating that oil prices did not experience extreme deviations from the general price levels during this period. During the pandemic period, the median oil price is notably lower than the pre-pandemic period, which reflects the significant impact of the pandemic on reducing oil prices. The IQR is wider in this period, suggesting increased volatility in oil prices during the pandemic. The presence of the outlier below the lower whisker indicates that there were instances of extremely low prices. In the post-pandemic period, the median oil price has increased from the pandemic period, suggesting a recovery in prices. The IQR is also wide, which indicates that the volatility continues, albeit with generally higher prices than during the pandemic. There are no outliers visible in the post-pandemic period, suggesting a stabilization of prices without extreme peaks or troughs. Overall, the graph shows a clear drop in median prices and an increase in volatility during the pandemic, followed by a recovery in the post-pandemic period.</p>
</section>
<section id="density-plot-for-policy-impact-analysis" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="density-plot-for-policy-impact-analysis"><span class="header-section-number">3.5</span> Density Plot for Policy Impact Analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>policy <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T72.xlsx"</span>, <span class="at">skip=</span><span class="dv">25</span>, <span class="at">col_types =</span> <span class="st">"numeric"</span>)[<span class="dv">22</span>, ]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(policy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Price"</span>, <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">228</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>long_policy <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(policy, <span class="at">cols =</span> <span class="sc">-</span>Price, <span class="at">names_to =</span> <span class="st">"Time"</span>, <span class="at">values_to =</span> <span class="st">"Oil_Price"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>long_policy<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2004-01-01"</span>), <span class="fu">as.Date</span>(<span class="st">"2022-12-31"</span>), <span class="at">by =</span> <span class="st">"month"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>long_policy<span class="sc">$</span>Period <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  long_policy<span class="sc">$</span>Time <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2014-07-01"</span>) <span class="sc">&amp;</span> long_covid<span class="sc">$</span>Time <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2016-12-31"</span>) <span class="sc">~</span> <span class="st">"Pre-Policy"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  long_policy<span class="sc">$</span>Time <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2017-01-01"</span>) <span class="sc">&amp;</span> long_covid<span class="sc">$</span>Time <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2019-06-30"</span>) <span class="sc">~</span> <span class="st">"Post-Policy"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Outside"</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>long_policy_filtered <span class="ot">&lt;-</span> long_policy <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Period <span class="sc">!=</span> <span class="st">"Outside"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>long_policy_filtered<span class="sc">$</span>Period <span class="ot">&lt;-</span> <span class="fu">factor</span>(long_policy_filtered<span class="sc">$</span>Period, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pre-Policy"</span>, <span class="st">"Post-Policy"</span>))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_policy_filtered, <span class="fu">aes</span>(<span class="at">x =</span> Oil_Price, <span class="at">fill =</span> Period)) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Density Plot of Oil Prices Pre- and Post- 2016 OPEC+ Production Cut Agreement'</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Price ($/b)"</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Density'</span>) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In late 2016, OPEC and non-OPEC oil-producing countries (known as OPEC+) agreed to cut oil output in an effort to end a global oil supply glut and boost prices. The pre-policy oil prices have a wide distribution, indicating variability in oil prices before the production cut agreement. There’s a noticeable peak around the 40 to 50 USD price range, suggesting that a significant number of oil price observations fell into this bracket. The post-policy oil prices exhibit a shift to the right and appear to be bimodal. This might indicate that the policy led to increased prices. Both distributions have a significant range, but the pre-policy distribution shows that the prices are more spread out across different values and have greater volatility. There is a big area of overlap between the two distributions in the 40 to 60 USD range. This indicates that while the policy shifted prices upwards, some of the pre-policy price range remained common post-policy.</p>
</section>
<section id="correlations-between-various-economic-indicators-and-oil-prices" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="correlations-between-various-economic-indicators-and-oil-prices"><span class="header-section-number">3.6</span> Correlations Between Various Economic Indicators and Oil Prices</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>price_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T72.xlsx"</span>)[<span class="dv">72</span>, ]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(price_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Price"</span>, <span class="fu">seq</span>(<span class="dv">1983</span>, <span class="dv">2022</span>))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>price_data <span class="ot">&lt;-</span> price_data[, <span class="fu">colSums</span>(<span class="fu">is.na</span>(price_data)) <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>long_price_data <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(price_data, <span class="at">cols =</span> <span class="sc">-</span>Price, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Oil_Price"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>long_price_data<span class="sc">$</span>Oil_Price <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(long_price_data<span class="sc">$</span>Oil_Price)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>gdp_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T23.xlsx"</span>)[<span class="dv">16</span>, ]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gdp_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GDP"</span>, <span class="fu">seq</span>(<span class="dv">1960</span>, <span class="dv">2022</span>))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>long_gdp_data <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(gdp_data, <span class="at">cols =</span> <span class="sc">-</span>GDP, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Real_GDP_Growth_Rate"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>petroleum_exports <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T25.xlsx"</span>, <span class="at">skip =</span> <span class="dv">2</span>, <span class="at">col_types =</span> <span class="st">"numeric"</span>)[<span class="dv">14</span>, ]</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>long_petroleum_exports <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(petroleum_exports, <span class="at">cols =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Petroleum_Exports"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>balance <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T27.xlsx"</span>, <span class="at">skip=</span><span class="dv">2</span>)[<span class="dv">14</span>, ]</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>long_balance <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(balance, <span class="at">cols =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Current_Account_Balances"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>tbl1 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(long_price_data, long_gdp_data, <span class="at">by =</span> <span class="st">"Year"</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>tbl2 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(tbl1, long_petroleum_exports, <span class="at">by =</span> <span class="st">"Year"</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>tbl3 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(tbl2, long_balance, <span class="at">by =</span> <span class="st">"Year"</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(tbl3[, <span class="fu">c</span>(<span class="st">"Oil_Price"</span>, <span class="st">"Real_GDP_Growth_Rate"</span>, <span class="st">"Petroleum_Exports"</span>, <span class="st">"Current_Account_Balances"</span>)]) <span class="sc">+</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot Matrix of Oil Prices and Economic Indicators of OPEC Members"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The matrix shows a strikingly high correlation of 0.989 between oil prices and petroleum exports, denoted by a strong upward trend in their scatter plot. This is expected, as higher oil prices would naturally boost the revenue from exports of petroleum, assuming export quantities remain relatively stable. The correlation between oil prices and current account balances is also robust at 0.872, indicating that the current account balances of OPEC members are strongly associated with oil prices. Higher oil prices typically translate into greater export revenues, contributing positively to the current account. The real GDP growth rate shows a weak correlation with oil prices (0.214). The low value suggests that the economic growth rates of OPEC members, as measured by real GDP growth, may not have a strong direct linear relationship with oil prices. In essence, the scatter plot matrix highlights that oil prices have a substantial and statistically significant correlation with petroleum exports and current account balances, which are critical economic parameters for oil-exporting countries. The real GDP growth rate’s connection to oil prices appears to be much less pronounced.</p>
</section>
<section id="multivariate-analysis-of-the-impact-of-production-factors" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="multivariate-analysis-of-the-impact-of-production-factors"><span class="header-section-number">3.7</span> Multivariate Analysis of the Impact of Production Factors</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>total_world_production <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T35.xlsx"</span>, <span class="at">na =</span> <span class="st">"na"</span>, <span class="at">skip =</span> <span class="dv">2</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>total_world_production <span class="ot">&lt;-</span> total_world_production[<span class="dv">1</span><span class="sc">:</span><span class="dv">74</span>, ]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(total_world_production)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Region"</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>total_world_production <span class="ot">&lt;-</span> <span class="fu">filter</span>(total_world_production, Region <span class="sc">==</span> <span class="st">"Total World"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="fu">as.character</span>(<span class="dv">1983</span><span class="sc">:</span><span class="dv">2022</span>))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>total_world_production <span class="ot">&lt;-</span> total_world_production[, selected_columns, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>total_world_import <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T56.xlsx"</span>, <span class="at">na =</span> <span class="st">"na"</span>, <span class="at">skip =</span> <span class="dv">2</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>total_world_import <span class="ot">&lt;-</span> total_world_import[<span class="dv">1</span><span class="sc">:</span><span class="dv">74</span>, ]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(total_world_import)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Region"</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>total_world_import <span class="ot">&lt;-</span> <span class="fu">filter</span>(total_world_import, Region <span class="sc">==</span> <span class="st">"Total world"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="fu">as.character</span>(<span class="dv">1983</span><span class="sc">:</span><span class="dv">2022</span>))</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>total_world_import <span class="ot">&lt;-</span> total_world_import[, selected_columns, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T72.xlsx"</span>, <span class="at">na =</span> <span class="st">"na"</span>, <span class="at">skip =</span> <span class="dv">50</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> oil_price[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, ]</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(oil_price)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Region"</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> <span class="fu">filter</span>(oil_price, Region <span class="sc">==</span> <span class="st">"OPEC - ORB"</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>import_data <span class="ot">&lt;-</span> total_world_import[<span class="dv">2</span><span class="sc">:</span><span class="dv">40</span>] </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>price_data <span class="ot">&lt;-</span> oil_price[<span class="dv">2</span><span class="sc">:</span><span class="dv">40</span>]   </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>production_data <span class="ot">&lt;-</span> total_world_production[<span class="dv">2</span><span class="sc">:</span><span class="dv">40</span>] </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>prod_minus_import_data <span class="ot">&lt;-</span> production_data <span class="sc">-</span> import_data</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">Oil_Price =</span> <span class="fu">as.numeric</span>(price_data),</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">World_Production =</span> <span class="fu">as.numeric</span>(production_data),</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">World_Import =</span> <span class="fu">as.numeric</span>(import_data),</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">Production_minus_Import =</span> <span class="fu">as.numeric</span>(prod_minus_import_data)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(combined_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>cor_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(cor_matrix)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cor_melted, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Variables"</span>) <span class="sc">+</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Variables"</span>) <span class="sc">+</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Correlations between Import production and Oil Price"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note: The sum of all line weights in the graph may exceed 1, as there might be overlaps between the organizations and regions listed. For example, OPEC may include most countries in the Middle East. We believe that countries with a larger relative share of crude oil exports in the world’s total exports have a greater impact on global oil prices. To understand the share of crude oil exports from various regions in the world’s total exports, we created this line graph, which includes the proportion of crude oil exports from major oil-exporting countries over the years. We found that OPEC has always been the largest oil-exporting organization, but its share in the world’s oil exports has been declining in recent years. On the other hand, the share of OECD’s oil exports in the world’s total exports has been increasing. This tells us that when analyzing data from 20 years ago, the focus should be on OPEC, but for more recent data, more attention may need to be given to emerging oil-exporting organizations like the OECD.</p>
</section>
<section id="multivariate-analysis-of-the-impact-of-production-factors-1" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="multivariate-analysis-of-the-impact-of-production-factors-1"><span class="header-section-number">3.8</span> Multivariate Analysis of the Impact of Production Factors</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>oil_production <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T35.xlsx"</span>, <span class="at">skip=</span><span class="dv">2</span>)[<span class="dv">62</span>, ]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>long_oil_production <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(oil_production, <span class="at">cols =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Oil_Production"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>biofuel_production <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T37.xlsx"</span>, <span class="at">skip=</span><span class="dv">2</span>)[<span class="dv">27</span>, ]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>long_biofuel_production <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(biofuel_production, <span class="at">cols =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Biofuel_Production"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>gas_production <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T93.xlsx"</span>, <span class="at">skip=</span><span class="dv">2</span>, <span class="at">col_types =</span> <span class="st">"numeric"</span>)[<span class="dv">75</span>, ]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>long_gas_production <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(gas_production, <span class="at">cols =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Natural_Gas_Production"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>demand <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T47.xlsx"</span>, <span class="at">skip=</span><span class="dv">2</span>, <span class="at">col_types =</span> <span class="st">"numeric"</span>)[<span class="dv">76</span>, ]</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>long_demand <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(demand, <span class="at">cols =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Oil_Demand"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(long_price_data, long_oil_production, <span class="at">by =</span> <span class="st">"Year"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(df3, long_demand, <span class="at">by =</span> <span class="st">"Year"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>df5 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(df4, long_biofuel_production, <span class="at">by =</span> <span class="st">"Year"</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>df6 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(df5, long_gas_production, <span class="at">by =</span> <span class="st">"Year"</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(df6, <span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Multivariate Analysis of Production Factors Influencing Oil Price Fluctuations"</span>, <span class="at">x =</span> <span class="st">"Production Variables"</span>, <span class="at">y =</span> <span class="st">"Standardized Values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The crossing lines between Oil Price and Oil Production suggest that the relationship between oil production and price isn’t consistent across the data points. Similarly, the lines between Oil Price and Oil Demand show varying trends, indicating that the price of oil doesn’t always move in tandem with demand. The Biofuel Production and Natural Gas Production axes show a wider spread of the lines, indicating varying levels of production across the data points. The relationship between these variables and oil prices is less clear, but there appears to be less direct correlation, as the lines do not show a consistent pattern when crossing from Oil Price to Biofuel Production and Natural Gas Production. There is a noticeable crisscrossing of lines across all variables, which highlights the complexity and potential interactions between these factors. It suggests that the impact on oil prices is multi-faceted and not dependent on a single factor. In conclusion, this parallel coordinates plot illustrates the complexity of the factors that impact oil prices. It suggests that oil prices are influenced by a combination of production, demand, and possibly the introduction of alternative energy sources, with no single factor consistently dominating the price movement. The varied crossing points of the lines suggest that these relationships are not linear and are likely influenced by a multitude of other economic, geopolitical, and market-specific factors not captured in this plot alone.</p>
</section>
<section id="interplay-of-tax-policies-and-gdp-growth-on-oil-price-segments" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="interplay-of-tax-policies-and-gdp-growth-on-oil-price-segments"><span class="header-section-number">3.9</span> Interplay of Tax Policies and GDP Growth on Oil Price Segments</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>low_high_cutoff <span class="ot">&lt;-</span> <span class="fu">quantile</span>(long_price_data<span class="sc">$</span>Oil_Price, <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>long_price_data<span class="sc">$</span>Price_Category <span class="ot">&lt;-</span> <span class="fu">cut</span>(long_price_data<span class="sc">$</span>Oil_Price, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, low_high_cutoff, <span class="cn">Inf</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>tax_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T81.xlsx"</span>, <span class="at">skip=</span><span class="dv">2</span>)[<span class="dv">44</span>, ]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tax_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Data"</span>, <span class="fu">seq</span>(<span class="dv">1984</span>, <span class="dv">2022</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>long_tax_data <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(tax_data, <span class="at">cols =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Tax"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>tax_changes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(long_tax_data<span class="sc">$</span>Tax) <span class="sc">/</span> <span class="fu">head</span>(long_tax_data<span class="sc">$</span>Tax, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>long_tax_data<span class="sc">$</span>Tax_Category <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tax_changes <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">'Tax Increase'</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">ifelse</span>(tax_changes <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">'Tax Cut'</span>, </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">'Stable Tax'</span>))</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T23.xlsx"</span>, <span class="at">skip=</span><span class="dv">2</span>)[<span class="dv">14</span>, ]</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>long_gdp_growth <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(gdp_growth, <span class="at">cols =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"GDP"</span>)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>low_growth_threshold <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>high_growth_threshold <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>long_gdp_growth<span class="sc">$</span>GDP_Category <span class="ot">&lt;-</span> <span class="fu">cut</span>(long_gdp_growth<span class="sc">$</span>GDP,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, low_growth_threshold,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                                               high_growth_threshold, <span class="cn">Inf</span>),</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low Growth"</span>, <span class="st">"Moderate Growth"</span>, </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"High Growth"</span>))</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(long_price_data, long_tax_data, <span class="at">by =</span> <span class="st">"Year"</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(t1, long_gdp_growth, <span class="at">by =</span> <span class="st">"Year"</span>) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>vcd<span class="sc">::</span><span class="fu">mosaic</span>(Price_Category <span class="sc">~</span> Tax_Category <span class="sc">+</span> GDP_Category, <span class="at">data =</span> t2,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"v"</span>, <span class="st">"v"</span>, <span class="st">"h"</span>),</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">highlighting_fill =</span> <span class="fu">c</span>(<span class="st">'blue'</span>, <span class="st">'pink'</span>, <span class="st">'green'</span>),</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">labeling_args =</span> <span class="fu">list</span>(<span class="at">rot_labels =</span> <span class="fu">c</span>(<span class="at">bottom =</span> <span class="dv">15</span>)),</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">"Impact of Tax Policies and GDP Growth on Oil Price Segments"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It appears that with tax cuts, oil prices tend to be predominantly in the Medium and High price categories. This representation suggests that tax cuts might be associated with a range of price levels but are less often associated with the lowest oil price category. For tax increases, the plot shows a more significant presence in the High oil price category across Low Growth and Moderate Growth categories. This could imply that tax increases aren’t necessarily more likely when oil prices and GDP growth are higher, possibly as a fiscal response to additional revenue from higher oil prices. In the Low Growth GDP category, there’s a substantial area in both the Medium and Low oil price categories, indicating that low GDP growth coincides with low oil prices in this dataset. For Moderate Growth, the distribution across oil price categories is relatively even, with High oil prices being slightly more prevalent. Interestingly, in the High Growth GDP category, the plot suggests a balanced distribution across the Medium and High oil price categories, with a smaller presence in the Low category. This suggests that higher economic growth may correlate with higher oil prices.</p>
</section>
<section id="correlations-between-dirty-tanker-price-and-oil-price" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="correlations-between-dirty-tanker-price-and-oil-price"><span class="header-section-number">3.10</span> Correlations between Dirty Tanker Price and Oil Price</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T72.xlsx"</span>, <span class="at">na =</span> <span class="st">"na"</span>, <span class="at">skip =</span> <span class="dv">50</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> oil_price[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, ]</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(oil_price)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Region"</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> <span class="fu">filter</span>(oil_price, Region <span class="sc">==</span> <span class="st">"OPEC - ORB"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>selected_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="fu">as.character</span>(<span class="dv">2011</span><span class="sc">:</span><span class="dv">2022</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> oil_price[, selected_columns, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>dirty_tanker_price <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"ASB2023_all/T62.xlsx"</span>, <span class="at">na =</span> <span class="st">"na"</span>, <span class="at">skip =</span> <span class="dv">3</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>dirty_tanker_price <span class="ot">&lt;-</span> dirty_tanker_price[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, ]</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dirty_tanker_price)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Region"</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>columns_to_remove <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">24</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>dirty_tanker_price <span class="ot">&lt;-</span> dirty_tanker_price[, <span class="sc">-</span>columns_to_remove, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>dirty_tanker_price <span class="ot">&lt;-</span> dirty_tanker_price[<span class="sc">-</span><span class="dv">2</span>, ]</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>new_column_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="fu">as.character</span>(<span class="dv">2011</span><span class="sc">:</span><span class="dv">2022</span>))</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dirty_tanker_price) <span class="ot">&lt;-</span> new_column_names</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dirty_tanker_price, oil_price)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(combined_df) <span class="ot">&lt;-</span> combined_df<span class="sc">$</span>Region</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>region_names <span class="ot">&lt;-</span> combined_df<span class="sc">$</span>Region</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>combined_df<span class="sc">$</span>Region <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>transposed_df <span class="ot">&lt;-</span> <span class="fu">t</span>(combined_df)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>transposed_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(transposed_df)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(transposed_df) <span class="ot">&lt;-</span> region_names</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(transposed_df) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(combined_df)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(transposed_df)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(transposed_df)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>melted_cor_matrix <span class="ot">&lt;-</span> <span class="fu">melt</span>(cor_matrix)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> melted_cor_matrix, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>, </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name=</span><span class="st">"Pearson</span><span class="sc">\n</span><span class="st">Correlation"</span>) <span class="sc">+</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>, <span class="at">title =</span> <span class="st">'Correlations between Dirty Tanker Price and Oil Price'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We’ve explored some interesting findings by creating a correlation matrix heatmap of dirty tanker prices and oil prices across different global regions. As anticipated, there is a positive correlation between oil prices and dirty tanker prices in most areas. Interestingly, the Middle East region exhibits a negative correlation between dirty tanker prices and oil prices. From our previous results, we know that there is a strong positive correlation between oil prices and export volumes. Therefore, when oil prices rise, export volumes also tend to increase, boosting the global demand for oil. This allows the Middle East, as the world’s leading oil-exporting region, to offset the increased transportation costs caused by the rise in oil prices</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./d3graph.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive graph</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>